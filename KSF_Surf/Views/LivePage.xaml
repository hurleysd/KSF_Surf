<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:d="http://xamarin.com/schemas/2014/forms/design"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             x:Class="KSF_Surf.Views.LivePage"
             Title="Live"
             x:Name="LiveTab"
             Style="{DynamicResource ContentPageStyle}">
    <ContentPage.ToolbarItems>
        <ToolbarItem x:Name="Settings">
        </ToolbarItem>
    </ContentPage.ToolbarItems>
    <!-- Laael Style -->
    <ContentPage.Resources>
    <ResourceDictionary>
            <Style x:Key = "ServerLabelStyle" TargetType="Label">
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="TextColor" Value="{DynamicResource GrayTextColor}"/>
                <Setter Property="LineBreakMode" Value="NoWrap"/>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <StackLayout Orientation="Vertical"
                 Padding="10,15,10,15">
        <Label Text="KSFClan Servers"
               Style="{DynamicResource HeaderLabel}"
               Margin="10,0,0,10"/>

        <!-- Servers -->
        <Frame Style="{StaticResource FrameStyle}">
            <Grid HorizontalOptions="FillAndExpand"
                  BackgroundColor="{DynamicResource ViewBackgroundColor}"
                  HeightRequest="1095"
                  Padding="10,6,10,6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="110"/>
                    <ColumnDefinition Width="1"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackLayout x:Name="ServerStack" 
                             Orientation="Vertical" 
                             Grid.Column="0"/>

                <BoxView Color="{DynamicResource SeparatorColor}"
                         Grid.Column="1"/>

                <StackLayout x:Name="MapsStack" 
                             Orientation="Vertical" 
                             Grid.Column="2"/>
            </Grid>
        </Frame>

        <StackLayout Orientation="Horizontal" 
                    Spacing="5" 
                    HorizontalOptions="Center">
            <Label x:Name="CSSServersLabel" 
                   Text="CS:S"
                   FontSize="22"
                   TextColor="{StaticResource TappedTextColor}">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Tapped="CSSLabel_Tapped"/>
                </Label.GestureRecognizers>
            </Label>

            <Label x:Name="CSGOServersLabel" 
                   Text="CS:GO"
                   FontSize="22"
                   TextColor="{DynamicResource GrayTextColor}">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Tapped="CSGOLabel_Tapped"/>
                </Label.GestureRecognizers>
            </Label>
        </StackLayout>
        
        
        <!-- Twitch Streams -->
        <Label Text="Surfer Streams"
               Style="{DynamicResource HeaderLabel}"
               Margin="10,0,0,10"/>

        <Frame Style="{StaticResource FrameStyle}">
            <RefreshView x:Name="StreamsRefreshView"
                     IsRefreshing="{Binding IsRefreshing}"
                     RefreshColor="{DynamicResource GrayTextColor}">
                <CollectionView x:Name ="StreamsCollectionView"
                  ItemsSource="{Binding Streams}"
                  SelectionMode="Single"
                  SelectionChanged="Stream_SelectionChanged"      
                  BackgroundColor="{DynamicResource ViewBackgroundColor}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="10, 6, 10, 6"
                                  BackgroundColor="{DynamicResource ViewBackgroundColor}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="1"/>
                                </Grid.RowDefinitions>

                                <Image Source="{Binding thumbnail_url}"
                                   Grid.RowSpan="2"
                                   Grid.Column="0"
                                   Grid.Row="0"
                                   Margin="0,0,5,0"/>

                                <Label Text="{Binding user_name}"
                                   LineBreakMode="NoWrap"
                                   TextColor="{DynamicResource HeaderTextColor}"
                                   FontSize="18"
                                   Grid.Row="0"
                                   Grid.Column="1"/>

                                <Label Text="{Binding title}"
                                   LineBreakMode="NoWrap"
                                   FontSize="14"
                                   TextColor="{DynamicResource GrayTextColor}"
                                   Grid.Row="1"
                                   Grid.Column="1"/>

                                <BoxView Color="{DynamicResource SeparatorColor}"
                                     HeightRequest="1"
                                     Grid.Row="2"
                                     Grid.Column="0"
                                     Grid.ColumnSpan="2"/>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                    <CollectionView.ItemsLayout>
                        <LinearItemsLayout Orientation="Vertical"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.EmptyView>
                        <Label Text="No streams online :("
                       TextColor="{DynamicResource GrayTextColor}"
                       FontSize="20"
                       HorizontalOptions="Fill"
                       VerticalOptions="Fill"
                       HorizontalTextAlignment="Center"
                       VerticalTextAlignment="Center"/>
                    </CollectionView.EmptyView>
                </CollectionView>
            </RefreshView>
        </Frame>
    </StackLayout>
</ContentPage>