<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:d="http://xamarin.com/schemas/2014/forms/design"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             x:Class="KSF_Surf.Views.LivePage"
             Title="Live"
             x:Name="LiveTab"
             Style="{StaticResource ContentPageStyle}">

    <StackLayout Padding="10"
                 Orientation="Vertical">
        <Label Text="KSFClan Servers"
               FontSize="26"/>

        <!-- Servers Carousel -->
        <CarouselView x:Name="ServersCarousel"
                      CurrentItemChanged="ServersCarousel_CurrentItemChanged"
                      BackgroundColor="LightGray"
                      MinimumHeightRequest="55"
                      IsSwipeEnabled="False"
                      IsScrollAnimated="False">
            <CarouselView.ItemTemplate>
                <DataTemplate>
                    <Grid BackgroundColor="LightGray"
                          Padding="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="1"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Label Text="{Binding server_names}" 
                               TextColor="Black" 
                               FontSize="20" 
                               HorizontalOptions="Start" 
                               WidthRequest="130"
                               Grid.Column="0"/>
                        <BoxView Grid.Column="1"
                                 Color="WhiteSmoke"/>
                        <Label Text="{Binding maps}" 
                               TextColor="Black" 
                               FontSize="20"
                               Grid.Column="2"/>
                    </Grid>
                </DataTemplate>
            </CarouselView.ItemTemplate>
        </CarouselView>

        <StackLayout Orientation="Horizontal" 
                     Spacing="3" 
                     HorizontalOptions="Center">
            <Label x:Name="CSSServersLabel" 
                   Text="CS:S"
                   FontSize="22"
                   TextColor="#147efb">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Tapped="CSSLabel_Tapped"/>
                </Label.GestureRecognizers>
            </Label>

            <Label x:Name="CSGOServersLabel" 
                   Text="CS:GO"
                   FontSize="22"
                   TextColor="Gray">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Tapped="CSGOLabel_Tapped"/>
                </Label.GestureRecognizers>
            </Label>
        </StackLayout>

        <!-- Twitch Streams -->
        <Label Text="Surfer Streams"               
                   FontSize="26"/>
        
        <RefreshView x:Name="StreamsRefreshView"
                     IsRefreshing="{Binding IsRefreshing}"
                     RefreshColor="WhiteSmoke">
            <CollectionView x:Name ="StreamsCollectionView"
                  ItemsSource="{Binding Streams}"
                  SelectionMode="Single"
                  SelectionChanged="Stream_SelectionChanged"      
                  BackgroundColor="LightGray">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="10, 6, 10, 6"
                          BackgroundColor="LightGray">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="1"/>
                        </Grid.RowDefinitions>

                        <Image Source="{Binding thumbnail_url}"
                               Grid.RowSpan="2"
                               Grid.Column="0"
                               Grid.Row="0"/>

                        <Label Text="{Binding user_name}"
                               LineBreakMode="NoWrap"
                               FontSize="18"
                               Grid.Row="0"
                               Grid.Column="1"/>

                        <Label Text="{Binding title}"
                               LineBreakMode="NoWrap"
                               FontSize="14"
                               TextColor="Gray"
                               Grid.Row="1"
                               Grid.Column="1"/>

                        <BoxView Color="WhiteSmoke"
                                 MinimumHeightRequest="1"
                                 Grid.Row="2"
                                 Grid.Column="0"
                                 Grid.ColumnSpan="2"/>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical"/>
            </CollectionView.ItemsLayout>
            <CollectionView.EmptyView>
                <Label Text="No streams online :("
                       TextColor="Gray"
                       FontSize="20"
                       HorizontalOptions="Fill"
                       VerticalOptions="Fill"
                       HorizontalTextAlignment="Center"
                       VerticalTextAlignment="Center"/>
            </CollectionView.EmptyView>
        </CollectionView>
        </RefreshView>

    </StackLayout>
</ContentPage>